/**
 * Created by xiaer on 2018/9/13.
 */

const enterData = [
  {
    "id": 2000,
    "name": "美食",
    "image": "/static/menu/1.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2001,
    "name": "商超便利",
    "image": "/static/menu/2.webp",
    "factors": [
      {
        "name": "超市",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "便利店",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "饮用水",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "啤酒",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "牛奶",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "冰品",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2002,
    "name": "午餐",
    "image": "/static/menu/3.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2003,
    "name": "水果",
    "image": "/static/menu/4.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2004,
    "name": "医药健康",
    "image": "/static/menu/5.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2005,
    "name": "浪漫鲜花",
    "image": "/static/menu/6.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2006,
    "name": "厨房生鲜",
    "image": "/static/menu/7.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2007,
    "name": "跑腿代购",
    "image": "/static/menu/8.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2008,
    "name": "地方小吃",
    "image": "/static/menu/9.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2009,
    "name": "麻辣烫",
    "image": "/static/menu/10.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2010,
    "name": "地方菜系",
    "image": "/static/menu/11.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  },
  {
    "id": 2011,
    "name": "特色栏目",
    "image": "/static/menu/1.webp",
    "factors": [
      {
        "name": "简餐便当",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "地方菜系",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "小吃炸串",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "面食粥点",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "香锅冒菜",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "轻食西餐",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "汉堡披萨",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      },
      {
        "name": "日韩料理",
        "image": "/static/menu/sub/1.webp",
        "restaurant_category_ids": [210]
      }
    ],
    "valid": {
      latitude: [-90, 90],
      longitude: [-90, 90]
    }
  }
]
const shopData = {
  "shopName": "福建沙县小车（光明南店）",
  "shopDesc": "",
  "shopHomeBg": "/static/restaurant/shop-bg.webp",
  "shopAvatar": "/static/restaurant/shop-avatar.webp",
  "shopNotice": "公告：温馨提示：9：00—17：00期间闭店状态可以下预订单！所有菜品不包含米饭，米饭需单点。不单独提供餐具，餐具只包含筷子和勺子，谢谢！",
  "shopDiscount": [
    {
      "id": 1,
      "name": "首",
      "desc": "新用户下单立减10元",
      "rules": {
        "fee": 0,
        "price": 10
      }
    },
    {
      "id": 2,
      "name": "减",
      "desc": "满20减3，满30减5，满50减8",
      "rules": {
        "fee": 50,
        "price": 8
      }
    }
  ],
  "shopCatalog": [
    {
      "id": 213,
      "name": "米粉面馆"
    },
    {
      "id": 237,
      "name": "地方小吃"
    }
  ],
  "shopInfos": {
    "tel": "111",
    "address": "海南省万宁市光明南路东侧189号"
  },
  "shopRecommend": {
    "isRecommend": false,
    "isAd": false,
    "reasonText": ""
  },
  "shopSend": {
    "id": 1,
    "text": "蜂鸟配送",
    "textColor": "#fff",
    "textBg": "#00AAFF",
    "rules": {
      "fee": 3,
      "price": 15,
      "name": "配送费¥3"
    }
  },
  "shopFoodList": [],
  "shopComment": [],
  "shopRate": 4.8,
  "shopOrder": [],
  "orderLeadTime": 27,
  "isBrand": true
}
const bannerData = [
  {
    "id": 20097233,
    "image": "/static/banner/1.webp",
    "url": ""
  },
  {
    "id": 20097234,
    "image": "/static/banner/2.webp",
    "url": ""
  },
  {
    "id": 20097235,
    "image": "/static/banner/3.webp",
    "url": ""
  },
  {
    "id": 20097236,
    "image": "/static/banner/4.webp",
    "url": ""
  },
  {
    "id": 20097237,
    "image": "/static/banner/5.webp",
    "url": ""
  },
  {
    "id": 20097238,
    "image": "/static/banner/6.webp",
    "url": ""
  },
  {
    "id": 20097239,
    "image": "/static/banner/7.webp",
    "url": ""
  }
]

const shopData = {
  "name": "前端渣渣店",
  "desc": "",
  "homeBg": "/static/restaurant/shop-bg.webp",
  "avatar": "/static/restaurant/shop-avatar.webp",
  "notice": "公告：温馨提示：9：00—17：00期间闭店状态可以下预订单！所有菜品不包含米饭，米饭需单点。不单独提供餐具，餐具只包含筷子和勺子，谢谢！",
  "discount": [
    {
      "id": 1,
      "name": "首",
      "desc": "新用户下单立减10元",
      "rules": {
        "fee": 0,
        "price": 10
      }
    },
    {
      "id": 2,
      "name": "减",
      "desc": "满20减3，满30减5，满50减8",
      "rules": {
        "fee": 50,
        "price": 8
      }
    }
  ],
  "catalog": [],
  "infos": {
    "tel": "111",
    "address": "海南省万宁市光明南路东侧189号"
  },
  "recommend": {
    "isRecommend": false,
    "isAd": false,
    "reasonText": ""
  },
  "send": {
    "id": 1,
    "text": "蜂鸟配送",
    "textColor": "#fff",
    "textBg": "#00AAFF",
    "rules": {
      "fee": 3,
      "price": 15,
      "name": "配送费¥3"
    }
  },
  "foodList": [],
  "comment": [],
  "rate": 4.8,
  "order": [],
  "leadTime": 27,
  "isBrand": true
}
const foodData = {
  "name": "鸡腿饭",
  "desc": "亲，别忘记点米饭~",
  "avatar": "/static/restaurant/shop-love.webp",
  "mounthCount": 21,
  "price": 12,
  "rate": 99,
  discount: {
    id: 201,
    name: '优惠2元'
  }
}

let cataLog = [{id: 210, name: '简单便餐'},{id: 211,name: '地方菜系'},{id:212,name: '小吃炸串'},{id:213,name:'面食粥点'},{id:214,name:'香锅冒菜'},{id:215,name:'轻食西餐'},{id:216, name: '汉堡披萨'},{id:217,name:'日韩料理'},{id: 218, name: '超市'},{id:219,name:'便利店'},{id:220,name: '饮用水'},{id:221,name:'啤酒'},{id:222,name: '牛奶'},{id:223,name:'冰品'}]
function getCatalog() {
  let index = Math.floor(Math.random() * cataLog.length)
  return cataLog[index]
}
Model.Foods.find({}, function (err,doc) {
  console.log(doc.length)
  let len = doc.length
  let index = 0

  while(index < len) {
    let shop = new Model.Shops(shopData)
    shop.rate = (Math.random() * 5).toFixed(2)
    shop.leadTime = Math.floor(Math.random() * 10) + 20
    shop.name += `-${index}`
    shop.catalog.push(getCatalog())
    for(let i = 0; i < 4; ++i) {
      let tmp = {
        "name": "【分类菜单】- " + i,
        "description": "美味实惠，大家快来抢~",
        foods: []
      }
      let foodsCount = Math.floor(Math.random() * 4) + 2
      for(let j = 0; j < foodsCount;++j) {


        let food = doc[index]
        if (!food) {
          break
        }
        tmp.foods.push(food._id)
        index++
      }
    }

    shop.save()
  }

})



Model.Foods.find({}, function (err, f) {
  let len = f.length
  let index = 0

  Model.Shops.find({}, function (err, doc) {
    doc.forEach(t => {
      let tmpClass
      let tmpI = Math.floor(Math.random()*5) + 2
      let tmpJ = Math.floor(Math.random()*8) + 2
      for (let i =0; i < tmpI; ++i) {
        tmpClass = {
          "name": "【分类菜单】- " + Math.random().toString(16).substr(3,2) + i,
          "description": "美味实惠，大家快来抢~",
          foods: []
        }

        let j
        for(j = 0; j < tmpJ; ++j) {
          let tmpIndex = index + j
          console.log(f[tmpIndex]._id)

          if (f[tmpIndex]._id) {
            tmpClass.foods.push(f[tmpIndex]._id)
            f[tmpIndex].shop = t._id
            f[tmpIndex].save()
          }
        }
        index += j
        t.foodList.push(tmpClass)
      }
      t.save()
    })
  })
})
